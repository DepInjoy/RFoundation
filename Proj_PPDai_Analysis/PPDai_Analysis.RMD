TITLE by YOUR_NAME_HERE
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
library(ggplot2)
library(gridExtra)
library(dplyr)
```
```{r echo=FALSE, message=FALSE, warning=FALSE Set_theme}
# 设置统一的主题
theme_set(theme_minimal(12))
```

```{r echo=FALSE, Load_the_Data}
# 加载数据
lc <- read.csv("ppdai/LC.csv", fileEncoding = "utf-8")
lp <- read.csv("ppdai/LP.csv", fileEncoding = "utf-8")
lcis <- read.csv("ppdai/LCIS.csv", fileEncoding = "utf-8")
```
```{r}
str(lc)
```
```{r warning=FALSE message = FALSE}
str(lp)
```
```{r warning=FALSE}
str(lcis)
```
```{r}
length(unique(lcis$ListingId))
length(unique(lc$ListingId))
length(unique(lp$ListingId))
```

```{r}
subset(lcis, lcis$recorddate == 41.83)
```

```{r}

```


# 单变量绘图选择

## 用户画像分析

### 不同性别的用户年龄分布关系
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(x = lc$'性别'), data = lc) +
    geom_histogram(stat = "count") +
    labs(x = "性别", y = "用户数", title = "不同性别用户数分布")
```
### 不同年龄的用户数分布关系
```{r warning=FALSE table_age, message=FALSE}
table(lc$'年龄')
```

```{r fig.width=30}
lc$age.group = cut(lc$'年龄', breaks = c(16, 18, 22, 25, 28, 35, 40, 60), right = F)
p1 <- ggplot(aes(x = age.group), data = lc) +
    geom_histogram(stat = "count") +
    labs(x = "用户年龄分组", y = "用户数",title = "不同年龄组用户数分布")

p2 <- ggplot(aes(x = age.group, fill =lc$'性别'), data = lc) +
    geom_histogram(stat = "count") +
    labs(x = "用户年龄分组", y = "用户数",title = "不同年龄组用户数分布")
grid.arrange(p1, p2, ncol=2)
```

## 用户基础数据分析
### 用户借款分布
```{r}
p1 <- ggplot(aes(lc$'借款类型'),data = lc) +
    geom_histogram(stat = "count") +
    labs(x = "用户借款类型", y = "人数", title = "用户借款类型分布关系图")
p2 <- ggplot(aes(x = lc$'借款类型', fill = lc$'性别'),data = lc) +
    geom_histogram(stat = "count") +
    labs(x = "用户借款类型", y = "人数", title = "不同性别和用户借款类型分布关系图")
grid.arrange(p1, p2, ncol=2)
```
### 借款金额分布

```{r}
ggplot(aes(x = lc$'借款金额'), data = lc) +
    geom_freqpoly() +
    scale_x_log10() +
    labs(x = "借款金额", y = "用户数", title="不同借款金额用户数量分布")
```
### 借款利率的用户数量分布
```{r}
ggplot(aes(x = lc$'借款利率'), data = lc) +
    geom_histogram(breaks=seq(6, 24, 0.5)) +
    scale_y_log10() +
    labs(x="借款利率", y="用户数", title="不同借款利率的用户数分布")
```

### 信用评级的用户数量分布
```{r}
p1 <- ggplot(aes(x = lc$'初始评级'), data = lc)+
    geom_histogram(stat = "count")+
    labs(x = "信用评级", y = "用户数", title="信用评级在用户数上分布")
p2 <- ggplot(aes(x = lc$'初始评级', fill=age.group), data = lc)+
    geom_histogram(stat = "count")+
    labs(x = "信用评级", y = "用户数", title="信用评级和用户年龄分组在用户数上分布情况")
grid.arrange(p1, p2, ncol=2)
```

### 历史正常还款次数的用户数分布
```{r}
table(lc$'历史成功借款次数')
```

```{r fig.width=35}
p1 <- ggplot(aes(x = lc$'历史成功借款次数'), data = lc) +
    geom_histogram() +
    scale_x_continuous(breaks = seq(0, 20, 1), limits = c(0,20)) +
    labs(x="历史成功借款次数", y="用户数", title="历史正常还款次数的用户数分布")

p2 <- ggplot(aes(x = lc$'历史成功借款次数', fill=lc$'初始评级'), data = lc) +
    geom_histogram() +
    scale_x_continuous(breaks = seq(0, 20, 1), limits = c(0,20)) +
    labs(x="历史成功借款次数", y="用户数", title="历史正常还款次数的用户数分布")
grid.arrange(p1, p2, ncol=2)
```

## 风险要素分析

### 违约概率PD

```{r}
lc$default_rate <- lc$'历史逾期还款期数' / lc$'历史成功借款次数'
p1 <- ggplot(aes(x = default_rate), data = lc) +
    geom_freqpoly()

grid.arrange(p1, ncol=2)
```

### 违约损失率LGD
```{r}
lc$LGD <- lc$'总待还本金'/lc$'借款金额'
p1 <- ggplot(aes(y =LGD), data = lc) +
    geom_boxplot() +
    scale_y_continuous(limits = c(0,8),breaks = seq(0, 8, 1)) +
    labs(y = "违约损失率LGD", title = "违约损失率箱线图")

p2 <- ggplot(aes(x = lc$'初始评级', y =LGD), data = lc) +
    geom_boxplot() +
    coord_cartesian(ylim = c(0,4.0)) +
    labs(x= "初始评级", y = "违约损失率LGD", title = "违约损失率箱线图")
grid.arrange(p1, p2, ncol=2)
```
```{r}
summary(lc$LGD)
```



### 到期日(Maturity)

### 违约时暴露(Exposure at Default, EAD)


## 获客指标分析
### 日新增用户数
```{r}

```

## 变现指标分析
### 贷款利率和违约率之间的关系
```{r}
ggplot(aes(x=lc$'借款利率', y=default_rate), data=lc) +
    geom_jitter(alpha=1/4) +
    labs(x="借款利率", y="违约率", title="贷款利率和借款利率之间的关系")
```

# 单变量分析

### 你的数据集结构是什么？

### 你的数据集内感兴趣的主要特性有哪些？

### 你认为数据集内哪些其他特征可以帮助你探索兴趣特点？

### 根据数据集内已有变量，你是否创建了任何新变量？

### 在已经探究的特性中，是否存在任何异常分布？你是否对数据进行一些操作，如清洁、调整或改变数据的形式？如果是，你为什么会这样做？



# 双变量绘图选择
```{r echo=FALSE, Bivariate_Plots}

```

# 双变量分析

### 探讨你在这部分探究中观察到的一些关系。这些感兴趣的特性与数据集内其他特性有什么区别？

### 你是否观察到主要特性与其他特性之间的有趣关系？

### 你发现最强的关系是什么？




# 多变量绘图选择

```{r echo=FALSE, Multivariate_Plots}

```

# 多变量分析

###  探讨你在这部分探究中观察到的一些关系。通过观察感兴趣的特性，是否存在相互促进的特性？

### 这些特性之间是否存在有趣或惊人的联系呢？

### 选项：你是否创建过数据集的任何模型？讨论你模型的优缺点。

------

# 定稿图与总结

### 绘图一
```{r echo=FALSE, Plot_One}

```

### 描述一


### 绘图二
```{r echo=FALSE, Plot_Two}

```

### 描述二


### 绘图三
```{r echo=FALSE, Plot_Three}

```

### 描述三

------

# 反思